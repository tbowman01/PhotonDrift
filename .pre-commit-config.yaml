# Pre-commit configuration for ADRScan
# See https://pre-commit.com for more information
# See https://pre-commit.com/hooks.html for more hooks

repos:
  # Standard pre-commit hooks
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.6.0
    hooks:
      - id: trailing-whitespace
        args: [--markdown-linebreak-ext=md]
      - id: end-of-file-fixer
      - id: check-yaml
      - id: check-toml
      - id: check-json
      - id: check-added-large-files
        args: ['--maxkb=1000']
      - id: check-merge-conflict
      - id: check-case-conflict
      - id: mixed-line-ending
        args: ['--fix=lf']

  # Rust-specific hooks
  - repo: local
    hooks:
      # Rust formatting check
      - id: rust-fmt
        name: Rust formatting check
        entry: cargo fmt --all -- --check
        language: system
        files: \.rs$
        pass_filenames: false
        description: "Check Rust code formatting with rustfmt"
        
      # Rust linting with clippy
      - id: rust-clippy
        name: Rust linting with clippy
        entry: cargo clippy --all-targets --all-features -- -D warnings
        language: system
        files: \.rs$
        pass_filenames: false
        description: "Lint Rust code with clippy (deny warnings)"
        
      # Rust compilation check
      - id: rust-check
        name: Rust compilation check
        entry: cargo check --all-targets --all-features
        language: system
        files: \.rs$
        pass_filenames: false
        description: "Check Rust code compilation"
        
      # Rust tests
      - id: rust-test
        name: Rust test suite
        entry: cargo test --all-features
        language: system
        files: \.rs$
        pass_filenames: false
        description: "Run Rust test suite"

  # Security scanning
  - repo: https://github.com/Yelp/detect-secrets
    rev: v1.5.0
    hooks:
      - id: detect-secrets
        args: ['--baseline', '.secrets.baseline']
        exclude: package.lock.json

  # Markdown linting
  - repo: https://github.com/igorshubovych/markdownlint-cli
    rev: v0.41.0
    hooks:
      - id: markdownlint
        args: ['--disable', 'MD013', 'MD033', 'MD041']
        exclude: '^(CHANGELOG\.md|hive-mind-prompt-swarm.*\.txt)$'

  # YAML formatting
  - repo: https://github.com/pre-commit/mirrors-prettier
    rev: v4.0.0-alpha.8
    hooks:
      - id: prettier
        types: [yaml]
        exclude: '\.github/workflows/.*\.yml$'

# Configuration
fail_fast: false
default_stages: [pre-commit]

# CI configuration
ci:
  autofix_commit_msg: |
    [pre-commit.ci] auto fixes from pre-commit hooks

    for more information, see https://pre-commit.ci
  autofix_prs: true
  autoupdate_branch: ''
  autoupdate_commit_msg: '[pre-commit.ci] pre-commit autoupdate'
  autoupdate_schedule: weekly
  skip: []
  submodules: false